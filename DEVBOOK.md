# DEVBOOK - HealthConnect Pro

## üìã Table des mati√®res
1. [Vue d'ensemble du projet](#vue-densemble-du-projet)
2. [Prompt de base](#prompt-de-base)
3. [Sp√©cifications techniques](#sp√©cifications-techniques)
4. [√âtat d'avancement d√©taill√©](#√©tat-davancement-d√©taill√©)
5. [Guide pour les agents IA](#guide-pour-les-agents-ia)
6. [Conventions de code](#conventions-de-code)
7. [Architecture du projet](#architecture-du-projet)
8. [Prochaines √©tapes prioritaires](#prochaines-√©tapes-prioritaires)

## üéØ Vue d'ensemble du projet

**HealthConnect Pro** est une plateforme web B2B permettant aux professionnels de sant√© de prendre des rendez-vous entre eux pour leurs patients. Par exemple, une infirmi√®re peut rechercher et prendre rendez-vous avec un kin√©sith√©rapeute pour son patient.

### Points cl√©s
- üè• Plateforme exclusivement B2B (entre professionnels)
- üö´ Pas de patients particuliers
- üíª Pas de t√©l√©consultation
- üé® Design moderne et professionnel
- üì± Interface responsive (PC et mobile)

## üìù Prompt de base

```
Plateforme de RDV entre Professionnels de Sant√©

Contexte du projet
Je souhaite cr√©er une plateforme web compl√®te permettant aux professionnels de sant√© de prendre des rendez-vous entre eux pour leurs patients. Par exemple, une infirmi√®re qui a besoin de soins de kin√©sith√©rapie pour son patient peut rechercher un kin√©sith√©rapeute disponible et prendre directement rendez-vous.

Points importants :
- Plateforme exclusivement B2B (entre professionnels)
- Pas de patients particuliers
- Pas de t√©l√©consultation
- Design moderne et professionnel
- Interface responsive (PC et mobile)
```

## üõ† Sp√©cifications techniques

### Stack obligatoire
| Technologie | Version | Utilisation |
|------------|---------|-------------|
| **Next.js** | 15.3 | Framework React avec App Router |
| **TypeScript** | 5+ | Typage strict sur tout le projet |
| **Tailwind CSS** | 4 | Styling et design system |
| **Supabase** | - | PostgreSQL + Auth + Storage |
| **React Hook Form** | 7.57+ | Gestion des formulaires |
| **Zod** | 3.25+ | Validation des donn√©es |
| **Shadcn/ui** | - | Composants UI avec Radix UI |
| **Lucide React** | - | Ic√¥nes |
| **Vercel** | - | D√©ploiement |

### APIs pr√©vues
- **Google Maps API** : G√©olocalisation et cartes
- **API de validation RPPS** : V√©rification des num√©ros RPPS (simul√©e en MVP)

### Structure de la base de donn√©es

#### Tables principales

1. **professionals**
   ```sql
   - id (UUID, PK)
   - email (TEXT, UNIQUE)
   - first_name, last_name (TEXT)
   - profession (ENUM)
   - rpps_number (TEXT, UNIQUE)
   - phone, address, city, postal_code (TEXT)
   - latitude, longitude (DECIMAL)
   - bio (TEXT)
   - avatar_url (TEXT)
   - created_at, updated_at (TIMESTAMP)
   ```

2. **appointments**
   ```sql
   - id (UUID, PK)
   - requester_id, provider_id (UUID, FK)
   - patient_first_name, patient_last_name, patient_phone (TEXT)
   - reason (TEXT)
   - appointment_date (DATE)
   - appointment_time (TIME)
   - duration (INTEGER)
   - status (ENUM: pending, confirmed, cancelled, completed)
   - notes (TEXT)
   - created_at, updated_at (TIMESTAMP)
   ```

3. **availabilities**
   ```sql
   - id (UUID, PK)
   - professional_id (UUID, FK)
   - day_of_week (INTEGER 0-6)
   - start_time, end_time (TIME)
   - is_active (BOOLEAN)
   ```

4. **blocked_slots**
   ```sql
   - id (UUID, PK)
   - professional_id (UUID, FK)
   - start_datetime, end_datetime (TIMESTAMP)
   - reason (TEXT)
   ```

## üìä √âtat d'avancement d√©taill√©

### ‚úÖ Fonctionnalit√©s impl√©ment√©es

#### 1. Infrastructure de base
- [x] Projet Next.js 15.3 avec App Router configur√©
- [x] TypeScript avec configuration stricte
- [x] Tailwind CSS 4 install√© et configur√©
- [x] ESLint configur√©
- [x] Structure de dossiers compl√®te

#### 2. Base de donn√©es Supabase
- [x] Sch√©ma SQL complet avec 4 tables
- [x] Types et √©num√©rations PostgreSQL
- [x] Indexes pour optimisation
- [x] Triggers pour `updated_at` automatique
- [x] Row Level Security (RLS) sur toutes les tables
- [x] Politiques RLS d√©finies
- [x] Donn√©es de test incluses
- [x] Configuration du bucket de storage pour avatars

#### 3. Authentification
- [x] Configuration Supabase Auth (client + serveur)
- [x] Page de connexion fonctionnelle (`/login`)
- [x] Page d'inscription avec validation RPPS (`/register`)
- [x] Middleware de protection des routes
- [x] Gestion des sessions avec refresh automatique
- [x] D√©connexion dans la navbar

#### 4. Interface utilisateur
- [x] Layout principal avec navbar et sidebar
- [x] Composants UI de base (Button, Input, Card, etc.)
- [x] Design system avec couleurs m√©dicales
- [x] Navigation responsive
- [x] Pages d'accueil et dashboard

#### 5. Gestion du profil
- [x] Page de profil compl√®te (`/profile`)
- [x] Formulaire de modification avec validation
- [x] Upload/suppression de photo de profil
- [x] Gestion des disponibilit√©s hebdomadaires
- [x] Composant `AvatarUpload`
- [x] Composant `AvailabilitySettings`

#### 6. API REST compl√®te
- [x] **`GET /api/professionals`** - Recherche avec filtres
  - [x] Filtres par profession, ville, code postal
  - [x] Recherche textuelle (nom, pr√©nom, bio)
  - [x] G√©olocalisation avec calcul de distance
  - [x] Pagination
- [x] **`GET /api/professionals/[id]`** - D√©tail professionnel
  - [x] Informations compl√®tes + disponibilit√©s
  - [x] Cr√©neaux bloqu√©s
  - [x] Statistiques de base
- [x] **`PUT /api/professionals/[id]`** - Mise √† jour profil
- [x] **`DELETE /api/professionals/[id]`** - Suppression compte
- [x] **`GET/PUT /api/professionals/[id]/availabilities`** - Gestion disponibilit√©s
- [x] **`GET/POST/DELETE /api/professionals/[id]/blocked-slots`** - Cr√©neaux bloqu√©s

#### 7. Hooks personnalis√©s
- [x] `useProfessionals` - Recherche et pagination
- [x] `useProfessional` - D√©tail d'un professionnel
- [x] `useAvailabilities` - Gestion des disponibilit√©s
- [x] Gestion d'erreurs centralis√©e
- [x] Types TypeScript stricts

#### 8. Composants de test
- [x] `ProfessionalsTestCard` - Interface de test des APIs

#### 9. Pages annuaire
- [x] **Page annuaire** (`/professionals`)
  - [x] Interface de recherche avec filtres avanc√©s
  - [x] Vue liste et grille responsive
  - [x] Pagination avec chargement progressif
  - [x] Filtres par profession, ville, recherche textuelle
  - [x] Navigation vers les profils d√©taill√©s
- [x] **Page d√©tail professionnel** (`/professionals/[id]`)
  - [x] Profil complet avec avatar et informations
  - [x] Horaires de disponibilit√©
  - [x] Actions rapides (appel, email, carte)
  - [x] Design responsive et professionnel

#### 10. Donn√©es de test
- [x] 12 professionnels fictifs avec donn√©es r√©alistes
- [x] Fonction de filtrage avec simulation d'API
- [x] Labels des professions harmonis√©s

### üîÑ Fonctionnalit√©s en cours
- [ ] Int√©gration Google Maps
- [ ] API des rendez-vous

### ‚ùå Fonctionnalit√©s √† impl√©menter

#### Phase 1 : Fonctionnalit√©s essentielles
- [ ] **R√©cup√©ration de mot de passe** (`/forgot-password`)
- [ ] **V√©rification d'email** apr√®s inscription
- [ ] **API Routes**
  - [x] `/api/professionals` - CRUD des professionnels ‚úÖ
  - [ ] `/api/appointments` - Gestion des RDV
- [x] **Annuaire des professionnels** (`/professionals`) ‚úÖ
- [x] **Page d√©tail professionnel** (`/professionals/[id]`) ‚úÖ
- [ ] **Syst√®me de prise de RDV**
  - [ ] Calendrier interactif
  - [ ] S√©lection de cr√©neaux
  - [ ] Formulaire patient
- [ ] **Gestion des RDV** (`/appointments`)
  - [ ] Liste des demandes envoy√©es/re√ßues
  - [ ] Actions (confirmer, annuler)
  - [ ] Export calendrier

#### Phase 2 : Fonctionnalit√©s avanc√©es
- [ ] **Notifications**
  - [ ] Email pour nouveaux RDV
  - [ ] Notifications in-app
- [ ] **Statistiques dashboard**
- [ ] **Gestion des indisponibilit√©s**
- [ ] **Int√©gration compl√®te Google Maps**
  - [ ] Autocomplete adresse
  - [ ] G√©ocodage automatique
  - [ ] Calcul de distances
  - [ ] Itin√©raires

#### Phase 3 : Fonctionnalit√©s futures
- [ ] Messagerie interne
- [ ] Synchronisation Google Calendar
- [ ] API publique
- [ ] Application mobile
- [ ] Gestion de documents

## ü§ñ Guide pour les agents IA

### Informations essentielles

1. **√âtat actuel** : L'authentification et la gestion de profil sont fonctionnelles. Le projet compile sans erreur.

2. **Configuration requise** :
   - Cr√©er `.env.local` avec les cl√©s Supabase
   - Ex√©cuter le sch√©ma SQL dans Supabase
   - Le bucket 'avatars' doit √™tre public

3. **Commandes utiles** :
   ```bash
   npm run dev     # D√©veloppement
   npm run build   # Build production
   npm run lint    # V√©rification du code
   ```

4. **Points d'attention** :
   - Toujours utiliser TypeScript strict
   - Suivre les conventions de code existantes
   - Utiliser les composants Shadcn/ui existants
   - Impl√©menter la gestion d'erreurs
   - Penser mobile-first

### Prochaine t√¢che recommand√©e

**Cr√©er l'API des rendez-vous** (`/api/appointments`) avec :
- CRUD complet des rendez-vous
- Validation des cr√©neaux et disponibilit√©s
- Notifications email automatiques
- Gestion des statuts (pending, confirmed, cancelled, completed)
- Int√©gration avec le calendrier des professionnels

**Alternative** : **Int√©grer Google Maps** pour :
- G√©olocalisation des professionnels
- Recherche par distance
- Affichage sur carte interactive
- Itin√©raires vers les cabinets

## üìê Conventions de code

### TypeScript
```typescript
// Toujours typer explicitement
interface Props {
  title: string
  onClick: () => void
}

// Utiliser les types du projet
import { Professional, Appointment } from '@/types'
```

### Composants React
```typescript
'use client' // Si n√©cessaire

import { useState } from 'react'
// Imports organis√©s : React, biblioth√®ques, composants, utils, types

export function ComponentName({ prop }: Props) {
  // Hooks en premier
  // Logique
  // Return JSX
}
```

### Gestion d'erreurs
```typescript
try {
  // Code
} catch (error) {
  setError(error instanceof Error ? error.message : 'Une erreur est survenue')
}
```

### Formulaires
- Toujours utiliser React Hook Form + Zod
- Validation c√¥t√© client ET serveur
- Messages d'erreur en fran√ßais

## üèó Architecture du projet

```
healthcare-booking/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/                    # Pages et routes Next.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (auth)/            # Routes publiques
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (dashboard)/       # Routes prot√©g√©es
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api/               # API Routes
‚îÇ   ‚îú‚îÄ‚îÄ components/            
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                # Composants r√©utilisables
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/              # Composants d'auth
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout/            # Layout (navbar, sidebar)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ professionals/     # Composants m√©tier
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ supabase/          # Config Supabase
‚îÇ   ‚îú‚îÄ‚îÄ types/                 # Types TypeScript
‚îÇ   ‚îî‚îÄ‚îÄ hooks/                 # Hooks personnalis√©s
‚îú‚îÄ‚îÄ supabase/
‚îÇ   ‚îî‚îÄ‚îÄ schema.sql             # Structure BDD
‚îî‚îÄ‚îÄ public/                    # Assets statiques
```

## üéØ Prochaines √©tapes prioritaires

1. **Cr√©er le fichier `.env.local`** avec les vraies cl√©s Supabase
2. **Impl√©menter l'API des professionnels** (`/api/professionals`)
3. **Cr√©er la page annuaire** avec recherche et filtres
4. **Int√©grer Google Maps** pour la g√©olocalisation
5. **Impl√©menter le syst√®me de prise de RDV**

## üìù Notes pour le d√©veloppement

- Le projet utilise le nouveau App Router de Next.js 15
- Pr√©f√©rer les Server Components quand possible
- Utiliser `'use client'` uniquement si n√©cessaire
- Les images de profil sont stock√©es dans Supabase Storage
- La validation RPPS est simul√©e pour le MVP
- Toujours penser √† l'exp√©rience mobile

## üîê S√©curit√©

- RLS activ√© sur toutes les tables
- Middleware pour prot√©ger les routes `/dashboard`
- Validation des donn√©es c√¥t√© client et serveur
- Pas de donn√©es sensibles dans le code
- Variables d'environnement pour les secrets

---

**Derni√®re mise √† jour** : 12/06/2025
**Agent** : Claude
**Version** : 1.0.0